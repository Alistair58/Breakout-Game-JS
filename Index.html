<html>
<head>
 <meta charset="utf-8"/>
 <title>Breakout Game</title>
 
 <style>
    .buttonHard {font-family:"Lucida Console";width: 50%;font-size:30px;cursor:pointer;transition-duration: 0.4s;border-radius: 10px;border-color:black;background-color:#e82a43;}
    * {padding: 0;margin:0;}
    .buttonHard:hover{background-color:white;border-color:#e82a43;;}
    .buttonMedium {font-family:"Lucida Console";width: 50%;font-size:30px;cursor:pointer;transition-duration: 0.4s;border-radius: 10px;border-color:black;background-color:#ebb821;;}
    * {padding: 0;margin:0;}
    .buttonMedium:hover{background-color:white;border-color:#ebb821;;}
    .buttonEasy {font-family:"Lucida Console";width: 50%;font-size:30px;cursor:pointer;transition-duration: 0.4s;border-radius: 10px;border-color:black;background-color:#1cd60f;}
    * {padding: 0;margin:0;}
    .buttonEasy:hover{background-color:white;border-color:#1cd60f;}
    .buttonPause {width:5%;font-size:50px;background-color:#e82a43;;cursor:pointer;border-radius:3px}
    .inputBox {background-color:black;color:white;border-radius: 5px;}
    .submitButton {background-color:black;color:white;border-radius: 5px;}
    canvas { background: black; display: block; margin: 0 auto; }
 </style>
</head>
<body style="background-color: grey;">
<button class = "button buttonPause" id="pauseButton" onclick="paused = true;">||</button> 
<br>
<center><h2 style="font-family:Lucida Console" id="startText">Choose your difficulty to begin</h2>
<br>
<button class="button buttonEasy" id="Btn1" title = "Large paddle and 3 lives" onclick="lives = 3; paddleWidth=100; difficultyChosen = true; allDone();">Easy</button>
<button class="button buttonMedium" id="Btn2" title = "Normal-sized paddle and 2 lives" onclick="lives = 2; paddleWidth=60; difficultyChosen = true; allDone();">Medium</button>
<button class="button buttonHard" id="Btn3" title = "Tiny paddle and only 1 life" onclick="lives = 1; paddleWidth=20; difficultyChosen = true; allDone();">Hard</button>
<br>
<form name="theForm" id="theForm">
    <label for="rowsInput">Input the number of rows you would like (maximum 8)</label><br>
    <input class="input inputBox" type="number" id="rowNumber" name="rowNumber" value=3>
    <input class="button submitButton" type="button" onclick = "rowsInputted();" value="Submit">
</form>
<br>
<form name="theForm2" id="theForm2">
    <label for="playerInput">Select the number of players</label><br>
    <input type="radio" id="1player" name="players" value=1>
    <label for="1player">1 Player</label><br>
    <input type="radio" id="2player" name="players" value=2>
    <label for="2player">2 Players</label><br>
    <input class="button submitButton"  type="button" onclick = "playersInputted();" value="Submit">
</form>
</center>
<br>
<canvas id="myCanvas" width="480" height="320">
</canvas>

<script>
 var canvas = document.getElementById("myCanvas");
 var ctx = canvas.getContext("2d");
 var ballRadius = 10;
 var speed = 10;
 var paddleHeight = 10;
 var paddleWidth = 60;
 var paddleX = (canvas.width-paddleWidth) / 2;
 var paddleY = (canvas.height-paddleHeight);
 var rightPressed = false;
 var leftPressed = false;
 var brickRowCount = 3;
 var brickColumnCount = 5;
 var brickWidth = 75;
 var brickHeight = 20;
 var brickPadding = 10;
 var brickOffsetTop = 30;
 var brickOffsetLeft = 30;
 var score = 0;
 var lives = 3;
 var paused = false;
 var difficultyChosen = false;
 var rowsChosen = false;
 var playersChosen = false;
 var count = 0;
 var bricks = []; //list of bricks
 let x = canvas.width/2;
 let y = canvas.height-30;
 let dx = 2;
 let dy = -2;

 function allDone(){
    if(rowsChosen == true && difficultyChosen == true &&  playersChosen == true) { //If both forms have been submitted
        draw();
    }
 }

 function rowsInputted() {
    var rows = document.getElementById("rowNumber").value;
    if(rows<1) {
        alert("Not enough rows");
        rowsChosen = false;
    }
    else if(rows>8) {
        alert("Too many rows");
        rowsChosen = false;
    }
    else {
        brickRowCount = rows;
        rowsChosen = true;
        var form = document.getElementById("theForm");
        form.style.visibility = "hidden";
        allDone();
    }
 }

 function playersInputted() {
    var playersSelected;
    var question = document.getElementsByName("players");
    for(var i=0;i<question.length;i++) {
        if(question[i].checked == true) {
            playersSelected = question[i].value;
            playersChosen = true;
            var form2 = document.getElementById("theForm2");
            form2.style.visibility = "hidden";
            allDone();
            break;
        }
    }
 }
 
 
 
 document.addEventListener("keydown", keyDownHandler, false);
 document.addEventListener("keyup", keyUpHandler, false);
 document.addEventListener("mousemove", mouseMoveHandler, false);
 var Btn1 = document.getElementById("Btn1");
 var Btn2 = document.getElementById("Btn2");
 var Btn3 = document.getElementById("Btn3");
 const startText = document.getElementById("startText");
 Btn1.addEventListener("click", () => {
    Btn1.style.visibility = "hidden";
    Btn2.style.visibility = "hidden";
    Btn3.style.visibility = "hidden";
    startText.style.visibility = "hidden";
 });
 Btn2.addEventListener("click", () => {
    Btn1.style.visibility = "hidden";
    Btn2.style.visibility = "hidden";
    Btn3.style.visibility = "hidden";
    startText.style.visibility = "hidden";
 });
 Btn3.addEventListener("click", () => {
    Btn1.style.visibility = "hidden";
    Btn2.style.visibility = "hidden";
    Btn3.style.visibility = "hidden";
    startText.style.visibility = "hidden";
 });
 
 

 function keyDownHandler(pressed) {
    if(pressed.key == "Right" || pressed.key == "ArrowRight") {
        rightPressed = true;
    }
    else if(pressed.key == "Left" || pressed.key == "ArrowLeft") {
        leftPressed = true;
    }
 }

 function keyUpHandler(notPressed) {
    if(notPressed.key == "Right" || notPressed.key == "ArrowRight") {
        rightPressed = false;
    }
    else if(notPressed.key == "Left" || notPressed.key == "ArrowLeft") {
        leftPressed = false;
    }
 }

 function mouseMoveHandler(e) {
    var relativeX = e.clientX - canvas.offsetLeft; //Distance from left edge
    if(relativeX >  paddleWidth/2 && relativeX < canvas.width-paddleWidth/2) { //If the mouse is in the canvas
        paddleX = relativeX - paddleWidth/2; //paddle location is set to mouse location
    }
 }

 function drawScore() {
    ctx.font = "16px Lucida Console";
    ctx.fillStyle = "#0095DD";
    ctx.fillText("Score: "+score, 8, 20);
 }
 function drawLives() {
    ctx.font = "16px Lucida Console";
    ctx.fillStyle = "#0095DD";
    ctx.fillText("Lives: "+lives, canvas.width-85, 20);
 }

 function drawBall() {
    //white circle with black outline
    ctx.beginPath();
    ctx.arc(x,y,ballRadius,0, Math.PI*2,false); //20 is the radius, 0 is the start angle in radians and Math.PI*2 is the end angle and false means draw anti-clockwise
    ctx.fillStyle = "white";
    ctx.fill();
    ctx.strokeStyle = "black";
    ctx.stroke();
    ctx.closePath();
    x += dx;
    y += dy;
 }

 function drawPaddle() {
    ctx.beginPath();
    ctx.rect(paddleX, paddleY, paddleWidth, paddleHeight);
    ctx.fillStyle = "blue";
    ctx.fill();
    ctx.strokeStyle = "black";
    ctx.stroke();
    ctx.closePath();
    if(rightPressed) {
        paddleX += 5;
        if (paddleX + paddleWidth > canvas.width){
            paddleX = canvas.width - paddleWidth;
        }
    }
    else if(leftPressed) {
        paddleX -= 5;
        if (paddleX < 0){
            paddleX = 0;
        }
    }
 }




    


 function drawBricks() {
    for(var c=0; c<brickColumnCount; c++) {
        for(var r=0; r<brickRowCount; r++) {
            if(bricks[c][r].status ==1) { //Draw if brick hasn't been hit
                var brickX = (c*(brickWidth+brickPadding)) +brickOffsetLeft; //x coordinate is the column X width (including padding) + the offset 
                var brickY = (r*(brickHeight+brickPadding)) + brickOffsetTop;
                bricks[c][r].x = brickX;
                bricks[c][r].y = brickY;
                ctx.beginPath();
                ctx.rect(brickX, brickY, brickWidth, brickHeight);
                if(r==0){
                    ctx.fillStyle = "#e82a43";
                }
                else if(r==1){
                    ctx.fillStyle = "#1cd60f";
                }
                else if(r==2){
                    ctx.fillStyle = "#ebb821";
                }
                else if(r==3){
                    ctx.fillStyle = "#ff99ff";
                }
                else if(r==4){
                    ctx.fillStyle = "#d67f1c";
                }
                else if(r==5){
                    ctx.fillStyle = "#9121db";
                }
                else if(r==6){
                    ctx.fillStyle = "#21dbc5";
                }
                else{
                    ctx.fillStyle = "#fa0590";
                }
                ctx.fill();
                ctx.closePath();
            }

        }
    }  
 }

 function collisionDetection() {
    for(var c=0; c<brickColumnCount; c++){
        for(var r=0; r<brickRowCount; r++){ //Iterates through every brick in the array
            var brick = bricks[c][r]; //Stores each brick as brick
            if(brick.status == 1){
                if(x > brick.x && x < brick.x+brickWidth && y > brick.y && y < brick.y+brickHeight) { //If the ball is between the x and y values of the brick
                    brick.status = 0;  //brick is now destroyed
                    dy = -dy; //Changes direction
                    score++;
                    if(score == brickRowCount*brickColumnCount){
                        alert("CONGRATULATIONS, you have won!");
                        document.location.reload(); //reloads the page
                    }
                }
            }
        }
    }
 }
 

 function bounce() {
    if(x + dx > canvas.width-ballRadius  || x + dx < ballRadius) { //If ball bounces off sides
        dx = -dx;
    }
        
    if(y + dy < ballRadius) { //If ball bounces off the top
        dy = -dy;            
    }
    if(x+ballRadius > paddleX && x-ballRadius < paddleX + paddleWidth && y + dy > (canvas.height-paddleHeight)-ballRadius+5) { // If the x and y coordinates of the ball is between each end of the paddle it bounces. 5 just seems to make it bounce in the right place
        dy = -dy;
    }
    else if(y + dy > canvas.height-ballRadius) { //If ball hits the bottom
        lives--;
        if(!lives) {
            alert("GAME OVER");
            document.location.reload();
        }
        else { //If there are lives left, the ball and paddle are reset
            x = Math.floor(Math.random()*canvas.width-ballRadius)+ballRadius;
            y = canvas.height-30;
            dx = 2;
            dy = -2;
            paddleX = (canvas.width-paddleWidth)/2;
        }
    }
 }
          
 

 

 function draw() {
    //clears screen so it doesn't leave a trail
    count ++
    if (count == 1) { //If it's the first loop create the brick list
        for(var c=0; c<brickColumnCount; c++) { //c is like an iteration variable in python. It increments by 1 on each loop. Loop ends when c >= column count.
            bricks[c] = []; // Creates a 2d array. Each column has its own list
            for(var r=0; r<brickRowCount; r++) {
                bricks[c][r] = { x: 0, y:0, status:1 }; //status 1 means the brick hasn't been destroyed
            }
        } 
    }
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBricks();
    drawBall();
    drawPaddle();
    drawScore();
    drawLives();
    collisionDetection();
    bounce();
    if (paused == true){
        alert("Paused\nPress OK to resume");
        paused = false;
    }
    requestAnimationFrame(draw);
  
    
 }

 

    
 

 
</script>

</body>
</html>